---
title: "MVR Project"
author: "Sanana Mwanawina"
date: "2025-03-12"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(ggplot2)
library(dplyr)
```

```{r}

# Read the dataset
data <- read.csv("C:/Users/sanan/OneDrive/Desktop/UCT/Masters/STA5069Z - Multivariate Analysis/Project/WA_Fn-UseC_-HR-Employee-Attrition.csv")

# Convert Attrition to a factor for proper categorical representation
data$Attrition <- as.factor(data$Attrition)

# Summary statistics for Attrition
attrition_summary <- data %>%
  group_by(Attrition) %>%
  summarise(Count = n()) %>%
  mutate(Percentage = round((Count / sum(Count)) * 100, 2))

print(attrition_summary)

# Visualization: Bar plot of Attrition
ggplot(data, aes(x = Attrition, fill = Attrition)) +
  geom_bar() +
  labs(title = "Attrition Distribution", x = "Attrition", y = "Count") +
  theme_minimal() +
  scale_fill_manual(values = c("No" = "lightblue", "Yes" = "coral"))

```

```{r}
ggplot(data, aes(x = factor(JobLevel), y = MonthlyIncome, fill = factor(JobLevel))) +
  geom_boxplot() +
  labs(title = "Monthly Income by Job Level", x = "Job Level", y = "Monthly Income") + scale_color_manual(values = c("pink", "lightblue", "palegreen", "orchid", "peachpuff"))

```

```{r}
ggplot(data, aes(x = Age)) +
  geom_histogram(binwidth = 5, fill = "lightblue", color = "black", alpha = 0.7) +
  labs(title = "Age Distribution of Employees", x = "Age", y = "Count") +
  theme_minimal()

```

```{r}
ggplot(data, aes(x = Age)) +
  geom_histogram(binwidth = 5, fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "Age Distribution of Employees", x = "Age", y = "Count") +
  theme_minimal()

```

```{r}
library(ggcorrplot)
library(dplyr)

# Select only numerical columns
num_vars <- data %>% select_if(is.numeric)

# Compute correlation matrix
corr_matrix <- cor(num_vars, use = "complete.obs")

# Plot heatmap using squares
ggcorrplot(corr_matrix, method = "square", lab = FALSE, type = "lower",
           title = "Correlation Heatmap of Key Variables")

```
